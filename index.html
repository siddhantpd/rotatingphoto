<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Optimized Falling Stars Carousel</title>
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background-color: #000;
        overflow: hidden;
        font-family: sans-serif;
        position: relative;
      }

      /* Canvas for stars */
      canvas#starfield {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
      }

      .carousel-container {
        perspective: 1000px;
        width: 300px;
        height: 400px;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10;
        position: relative;
      }

      .carousel {
        position: relative;
        width: 100%;
        height: 100%;
        transform-style: preserve-3d;
        transform: rotateX(-25deg);
        transition: transform 0.5s ease-out;
        cursor: grab;
        will-change: transform;
      }

      .carousel.is-dragging {
        cursor: grabbing;
        transition: none;
      }

      .carousel-item {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 180px;
        height: 250px;
        object-fit: cover;
        border-radius: 5px;
        border: 5px solid white;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        transform: translate(-50%, -50%) rotateY(0deg);
        backface-visibility: hidden;
        will-change: transform;
      }

      .carousel-item:nth-child(1) {
        transform: translate(-50%, -50%) rotateY(0deg) translateZ(250px);
      }
      .carousel-item:nth-child(2) {
        transform: translate(-50%, -50%) rotateY(72deg) translateZ(250px);
      }
      .carousel-item:nth-child(3) {
        transform: translate(-50%, -50%) rotateY(144deg) translateZ(250px);
      }
      .carousel-item:nth-child(4) {
        transform: translate(-50%, -50%) rotateY(216deg) translateZ(250px);
      }
      .carousel-item:nth-child(5) {
        transform: translate(-50%, -50%) rotateY(288deg) translateZ(250px);
      }
    </style>
  </head>
  <body>
    <!-- Starfield -->
    <canvas id="starfield"></canvas>

    <!-- Carousel -->
    <div class="carousel-container">
      <div class="carousel">
            <img src="photo1.jpg" alt="Photo 1" class="carousel-item">
            <img src="photo2.jpg" alt="Photo 2" class="carousel-item">
            <img src="photo3.jpg" alt="Photo 3" class="carousel-item">
            <img src="photo4.jpg" alt="Photo 4" class="carousel-item">
            <img src="photo5.jpg" alt="Photo 5" class="carousel-item">
        
        </div>
    </div>

    <script>
      /* ---------- Falling Stars Canvas ---------- */
      const canvas = document.getElementById("starfield");
      const ctx = canvas.getContext("2d");
      let stars = [];
      let w, h;

      function resizeCanvas() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
        stars = Array.from({ length: 50 }, () => ({
          // ðŸ”¹ now 50 stars only
          x: Math.random() * w,
          y: Math.random() * h,
          size: Math.random() * 2,
          speed: 0.5 + Math.random() * 1.5,
        }));
      }

      function animateStars() {
        ctx.clearRect(0, 0, w, h);
        ctx.fillStyle = "white";
        stars.forEach((star) => {
          ctx.beginPath();
          ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
          ctx.fill();
          star.y += star.speed;
          if (star.y > h) {
            star.y = 0;
            star.x = Math.random() * w;
          }
        });
        requestAnimationFrame(animateStars);
      }

      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();
      animateStars();

      /* ---------- Carousel Rotation ---------- */
      const carousel = document.querySelector(".carousel");
      let isDragging = false;
      let startX;
      let rotationY = 0;
      let pendingDx = 0;
      let animating = false;

      function updateRotation() {
        if (!animating) return;
        rotationY += pendingDx * 0.5;
        pendingDx = 0;
        carousel.style.transform = `rotateX(-25deg) rotateY(${rotationY}deg)`;
        requestAnimationFrame(updateRotation);
      }

      function startDrag(x) {
        isDragging = true;
        startX = x;
        carousel.classList.add("is-dragging");
        if (!animating) {
          animating = true;
          requestAnimationFrame(updateRotation);
        }
      }

      function endDrag() {
        isDragging = false;
        carousel.classList.remove("is-dragging");
        animating = false;
      }

      function moveDrag(x) {
        if (!isDragging) return;
        const dx = x - startX;
        pendingDx += dx;
        startX = x;
      }

      // Touch
      carousel.addEventListener("touchstart", (e) =>
        startDrag(e.touches[0].clientX)
      );
      document.addEventListener("touchend", endDrag);
      document.addEventListener("touchmove", (e) =>
        moveDrag(e.touches[0].clientX)
      );

      // Mouse
      carousel.addEventListener("mousedown", (e) => startDrag(e.clientX));
      document.addEventListener("mouseup", endDrag);
      document.addEventListener("mousemove", (e) => moveDrag(e.clientX));
    </script>
  </body>
</html>
